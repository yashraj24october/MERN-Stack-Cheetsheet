Let in our mongoDB database, there are billions of document.
In this case for finding a particular record conditionally will be very time consuming and heavy task and will take a long time or may fail as it will scan all the billions record.


To optimize this task and make the searching fast in case of billions of records, we have two efficient way:


  1. Indexing
	2. Sharding

	1. Indexing: Indexes support the efficient execution of queries. Without them, the database must scan every document in a collection or table to select those that match the query statement. If an appropriate index exists for a query, the database can use the index to limit the number of documents it must inspect.

db.<collectionName>.createIndex({ <field>: 1 }, { unique: true })
== when field has unique value

For non-unique field,
db.<collectionName>.createIndex({ <field>: 1 })


* Indexing is very fast in mongoDB, it uses B-Tree Algorithm for storing the records in index and accessing any record in index is very fast using it.

Eg: Even we have billions of records of user and we have to search a user by name ‘John’
Using indexing, it will take just 1-15 ms.
	
	
	2. Sharding: When the database becomes HUGE (TBs), enable sharding.

* Sharding means splitting a huge MongoDB database into multiple servers

* Using sharding, we can make querying database very fast as:  instead of one server searching billions of records, 3 servers search in parallel → 3× faster.
	* Sharding gives:
         ✔ Infinite scalability
         ✔ Faster reads
         ✔ Faster writes
         ✔ Balanced load
         ✔ High availability

Sharding only works efficiently when we have our project on docker or we are using mongoDB atlas.
MongoDB atlas
	* On mongoDB atlas, we simply choose a Sharded Cluster when creating a project. Mongodb atlas fully supports sharding, we don’t need to do configuration for sharding setup. Just, we need to enable sharding and define collection to use sharding in code.
	* But MongoDB Atlas Free Tier (M0 cluster), M2 (Shared) and M5 (Shared) tier does not support sharding.
	* For Sharding, we must have (M10 and above) or Dedicated clusters.

Docker
	* On Docker, for sharding , we need to manually create sharding setup that is: 1 Config Server Replica Set, Shards (each shard = replica set) and 1 Mongos Router.

—---------------


Let we have a sharding setup complete (Using MongoDB atlas or docker).
To use sharding feature for our project, we do:
	MongoDB atlas (eg: M10/Dedicated cluster)

After deploying a cluster:
	
	Click “Connect”
	Choose “Connect with MongoDB Shell”
	Copy the connection command (looks like): mongosh "mongodb+srv://cluster0.xxxxxx.mongodb.net/mydb"
	Paste the command in terminal and connect.
	After connect: Enable Sharding
sh.enableSharding("databaseName")
	 Choose a Shard Key & Shard a Collection:
sh.shardCollection("databaseName.collection_name", { _id: "hashed" }
	Verify sharding
sh.status()

== we will see:
	- Config servers
	- Shards
	- Sharded collections
	- Chunk distribution
	AFTER we enable sharding AND shard a collection, MongoDB will automatically shard our data as the collection grows.
	

